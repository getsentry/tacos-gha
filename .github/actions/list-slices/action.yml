name: Determine Editted TF Slices

inputs:
  shell:
    description: "private -- do not use"
    default: env ./tacos-gha/lib/ci/default-shell {0}

outputs:
  slices:
    description: "JSON list of paths to relevant TF/TG slices"
    value: ${{ steps.list-slices.outputs.slices }}

runs:
  using: composite

  steps:
    - uses: ./tacos-gha/.github/actions/just-the-basics

    - id: files
      uses: dorny/paths-filter@0bc4621a3135347011ad047f9ecf449bf72ce2bd
      with:
        filters: "all: ['**']"
        list-files: json

    - name: List Slices
      id: list-slices
      shell: ${{inputs.shell}}
      run: |
        "$TACOS_GHA_HOME/"lib/ci/list-slices <<'EOF'
        ${{steps.files.outputs.all_files}}
        EOF
